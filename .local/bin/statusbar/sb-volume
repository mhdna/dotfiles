#!/bin/sh

case $BLOCK_BUTTON in
	3) setsid -f "$TERMINAL" -e pulsemixer >/dev/null 2>&1;;
	2) wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle ;;
	4) wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+ ;;
	5) wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%- ;;
esac

vol="$(wpctl get-volume @DEFAULT_AUDIO_SINK@)"

if [ "$vol" != "${vol%\[MUTED\]}" ]; then
    echo MUTED
else
    vol="${vol#Volume: }"
    split() {
        # For ommiting the . without calling and external program.
        IFS=$2
        set -- $1
        printf '%s' "$@"
    }
    vol="$(split "$vol" ".")"
    vol="${vol##0}"

    echo "V: $vol%"
fi
